{"ast":null,"code":"var _jsxFileName = \"D:\\\\Airticket\\\\frontend\\\\src\\\\components\\\\CouponInput.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './CouponInput.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CouponInput = ({\n  onCouponApplied,\n  onCouponRemoved,\n  initialCoupon = null,\n  originalAmount = 0\n}) => {\n  _s();\n  const [couponCode, setCouponCode] = useState((initialCoupon === null || initialCoupon === void 0 ? void 0 : initialCoupon.code) || '');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [appliedCoupon, setAppliedCoupon] = useState(initialCoupon);\n  useEffect(() => {\n    // Update originalAmount when prop changes\n    if (originalAmount !== undefined) {\n      // This will trigger re-validation if needed\n    }\n  }, [originalAmount]);\n  const handleApplyCoupon = async () => {\n    if (!couponCode.trim()) {\n      setError('Vui lòng nhập mã giảm giá');\n      return;\n    }\n    setLoading(true);\n    setError('');\n    try {\n      const token = localStorage.getItem('accessToken');\n      const response = await fetch('http://localhost:8080/api/v1/coupons/validate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          code: couponCode.trim(),\n          orderValue: originalAmount,\n          userId: JSON.parse(localStorage.getItem('user') || '{}')._id\n        })\n      });\n      const data = await response.json();\n      if (response.ok && data.success) {\n        setAppliedCoupon(data.data.coupon);\n        onCouponApplied(data.data);\n        setError('');\n      } else {\n        setError(data.message || 'Mã giảm giá không hợp lệ');\n        setAppliedCoupon(null);\n        onCouponRemoved();\n      }\n    } catch (err) {\n      setError('Không thể kiểm tra mã giảm giá. Vui lòng thử lại.');\n      console.error('Error validating coupon:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleRemoveCoupon = () => {\n    setCouponCode('');\n    setAppliedCoupon(null);\n    setError('');\n    onCouponRemoved();\n  };\n  const formatCurrency = amount => {\n    return new Intl.NumberFormat('vi-VN', {\n      style: 'currency',\n      currency: 'VND'\n    }).format(amount);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"coupon-input-container\",\n    children: !appliedCoupon ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"coupon-input-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"coupon-input-field\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Nh\\u1EADp m\\xE3 gi\\u1EA3m gi\\xE1 (WELCOME10, SAVE20...)\",\n          value: couponCode,\n          onChange: e => setCouponCode(e.target.value.toUpperCase()),\n          className: error ? 'coupon-input error' : 'coupon-input'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: handleApplyCoupon,\n          disabled: loading || !couponCode.trim(),\n          className: \"coupon-apply-btn\",\n          children: loading ? 'Đang kiểm tra...' : 'Áp dụng'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"coupon-error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"coupon-applied\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"coupon-applied-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"coupon-applied-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"coupon-code\",\n            children: [\"\\uD83C\\uDFAB \", appliedCoupon.code]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"coupon-description\",\n            children: appliedCoupon.description || `${appliedCoupon.discountType === 'percentage' ? 'Giảm ' + appliedCoupon.discountValue + '%' : 'Giảm ' + formatCurrency(appliedCoupon.discountValue)}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"coupon-expiry\",\n            children: [\"H\\u1EBFt h\\u1EA1n: \", new Date(appliedCoupon.expiryDate).toLocaleDateString('vi-VN')]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: handleRemoveCoupon,\n          className: \"coupon-remove-btn\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"coupon-discount-info\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"discount-badge\",\n          children: appliedCoupon.discountType === 'percentage' ? `${appliedCoupon.discountValue}%` : formatCurrency(appliedCoupon.discountValue)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n_s(CouponInput, \"pRU8EhaE+DKZ3c7nwcS7LNv4KPU=\");\n_c = CouponInput;\nexport default CouponInput;\nvar _c;\n$RefreshReg$(_c, \"CouponInput\");","map":{"version":3,"names":["React","useState","useEffect","jsxDEV","_jsxDEV","CouponInput","onCouponApplied","onCouponRemoved","initialCoupon","originalAmount","_s","couponCode","setCouponCode","code","loading","setLoading","error","setError","appliedCoupon","setAppliedCoupon","undefined","handleApplyCoupon","trim","token","localStorage","getItem","response","fetch","method","headers","body","JSON","stringify","orderValue","userId","parse","_id","data","json","ok","success","coupon","message","err","console","handleRemoveCoupon","formatCurrency","amount","Intl","NumberFormat","style","currency","format","className","children","type","placeholder","value","onChange","e","target","toUpperCase","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","description","discountType","discountValue","Date","expiryDate","toLocaleDateString","_c","$RefreshReg$"],"sources":["D:/Airticket/frontend/src/components/CouponInput.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './CouponInput.css';\n\nconst CouponInput = ({ onCouponApplied, onCouponRemoved, initialCoupon = null, originalAmount = 0 }) => {\n  const [couponCode, setCouponCode] = useState(initialCoupon?.code || '');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [appliedCoupon, setAppliedCoupon] = useState(initialCoupon);\n\n  useEffect(() => {\n    // Update originalAmount when prop changes\n    if (originalAmount !== undefined) {\n      // This will trigger re-validation if needed\n    }\n  }, [originalAmount]);\n\n  const handleApplyCoupon = async () => {\n    if (!couponCode.trim()) {\n      setError('Vui lòng nhập mã giảm giá');\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n\n    try {\n      const token = localStorage.getItem('accessToken');\n      const response = await fetch('http://localhost:8080/api/v1/coupons/validate', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`,\n        },\n        body: JSON.stringify({\n          code: couponCode.trim(),\n          orderValue: originalAmount,\n          userId: JSON.parse(localStorage.getItem('user') || '{}')._id,\n        }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok && data.success) {\n        setAppliedCoupon(data.data.coupon);\n        onCouponApplied(data.data);\n        setError('');\n      } else {\n        setError(data.message || 'Mã giảm giá không hợp lệ');\n        setAppliedCoupon(null);\n        onCouponRemoved();\n      }\n    } catch (err) {\n      setError('Không thể kiểm tra mã giảm giá. Vui lòng thử lại.');\n      console.error('Error validating coupon:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRemoveCoupon = () => {\n    setCouponCode('');\n    setAppliedCoupon(null);\n    setError('');\n    onCouponRemoved();\n  };\n\n  const formatCurrency = (amount) => {\n    return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);\n  };\n\n  return (\n    <div className=\"coupon-input-container\">\n      {!appliedCoupon ? (\n        <div className=\"coupon-input-form\">\n          <div className=\"coupon-input-field\">\n            <input\n              type=\"text\"\n              placeholder=\"Nhập mã giảm giá (WELCOME10, SAVE20...)\"\n              value={couponCode}\n              onChange={(e) => setCouponCode(e.target.value.toUpperCase())}\n              className={error ? 'coupon-input error' : 'coupon-input'}\n            />\n            <button\n              type=\"button\"\n              onClick={handleApplyCoupon}\n              disabled={loading || !couponCode.trim()}\n              className=\"coupon-apply-btn\"\n            >\n              {loading ? 'Đang kiểm tra...' : 'Áp dụng'}\n            </button>\n          </div>\n          {error && <div className=\"coupon-error\">{error}</div>}\n        </div>\n      ) : (\n        <div className=\"coupon-applied\">\n          <div className=\"coupon-applied-header\">\n            <div className=\"coupon-applied-info\">\n              <div className=\"coupon-code\">🎫 {appliedCoupon.code}</div>\n              <div className=\"coupon-description\">\n                {appliedCoupon.description || `${appliedCoupon.discountType === 'percentage' ? 'Giảm ' + appliedCoupon.discountValue + '%' : 'Giảm ' + formatCurrency(appliedCoupon.discountValue)}`}\n              </div>\n              <div className=\"coupon-expiry\">\n                Hết hạn: {new Date(appliedCoupon.expiryDate).toLocaleDateString('vi-VN')}\n              </div>\n            </div>\n            <button\n              type=\"button\"\n              onClick={handleRemoveCoupon}\n              className=\"coupon-remove-btn\"\n            >\n              ✕\n            </button>\n          </div>\n          <div className=\"coupon-discount-info\">\n            <div className=\"discount-badge\">\n              {appliedCoupon.discountType === 'percentage'\n                ? `${appliedCoupon.discountValue}%`\n                : formatCurrency(appliedCoupon.discountValue)\n              }\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default CouponInput;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}